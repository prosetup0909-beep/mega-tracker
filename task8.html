<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task 08 - Lyrics Scraper Word Cloud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.2.2/src/wordcloud2.min.js"></script>
    <style>
        body { background: #0f172a; color: white; }
        .canvas-container { 
            background: #1e293b; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
        }
    </style>
</head>
<body class="p-10">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-center text-blue-400 mb-8 uppercase tracking-widest">
            Lyric Scraper & Word Cloud
        </h1>

        <div class="bg-slate-800 p-6 rounded-2xl mb-10 flex flex-col md:flex-row gap-4 items-end">
            <div class="flex-1">
                <label class="block text-xs font-bold text-slate-500 mb-2">ARTIST NAME</label>
                <input id="artist" type="text" placeholder="e.g. Coldplay" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg outline-none focus:border-blue-500">
            </div>
            <div class="flex-1">
                <label class="block text-xs font-bold text-slate-500 mb-2">SONG TITLE</label>
                <input id="song" type="text" placeholder="e.g. Yellow" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg outline-none focus:border-blue-500">
            </div>
            <button onclick="scrapeAndCloud()" class="bg-blue-600 hover:bg-blue-700 px-10 py-3 rounded-lg font-bold transition-all">
                SCRAPE & GENERATE
            </button>
        </div>

        <div id="status" class="text-center mb-4 text-blue-400 font-mono text-sm h-6"></div>

        <div class="canvas-container flex justify-center p-4">
            <canvas id="cloudCanvas" width="800" height="450" class="max-w-full"></canvas>
        </div>
    </div>

    <script>
        async function scrapeAndCloud() {
            const artist = document.getElementById('artist').value;
            const song = document.getElementById('song').value;
            const status = document.getElementById('status');
            const canvas = document.getElementById('cloudCanvas');

            if (!artist || !song) return alert("Please enter Artist and Song name!");

            status.innerText = "SCRAPING LYRICS FROM DATABASE...";

            try {
                // Fetching (Scraping) the lyrics from a public source
                const response = await fetch(`https://api.lyrics.ovh/v1/${artist}/${song}`);
                const data = await response.json();

                if (!data.lyrics) {
                    status.innerText = "Error: Could not scrape lyrics for this song.";
                    return;
                }

                status.innerText = "SCRAPE SUCCESSFUL. ANALYZING FREQUENCY...";

                // Process the scraped text
                const text = data.lyrics.toLowerCase()
                    .replace(/[^\w\s]/g, "") // Clean punctuation
                    .split(/\s+/)            // Split into words
                    .filter(w => w.length > 3); // Filter common small words

                // Count word occurrences (Frequency)
                const freqMap = {};
                words.forEach(word => {
                    freqMap[word] = (freqMap[word] || 0) + 1;
                });

                // Convert to the format needed for the Word Cloud library
                const list = Object.entries(freqMap).map(([text, count]) => [text, count * 10]);

                // Generate the Word Cloud visual
                WordCloud(canvas, { 
                    list: list,
                    gridSize: 10,
                    weightFactor: 2,
                    color: 'random-light',
                    backgroundColor: '#1e293b',
                    rotateRatio: 0.5
                });

                status.innerText = "WORD CLOUD GENERATED SUCCESSFULLY!";

            } catch (error) {
                status.innerText = "Network Error: Could not connect to scraping source.";
            }
        }
    </script>
</body>
</html>
